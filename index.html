<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Susy, ¬øQuieres ser mi San Valent√≠n?</title>

<style>
  :root{ --bg1:#ff9a9e; --bg2:#fad0c4; }

  html, body { height: 100%; margin: 0; }
  body{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, var(--bg1), var(--bg2));
    background-attachment: fixed;
    overflow:hidden;
    position:relative;
  }

  h1{
    color:#fff;
    text-shadow:2px 2px 5px #000;
    text-align:center;
    padding:0 16px;
    z-index:5;
  }

  #buttons{
    margin-top:30px;
    position:relative;
    width:100%;
    height:220px;
    z-index:6;
  }

  button{
    font-size:20px;
    padding:15px 30px;
    margin:10px;
    border:none;
    border-radius:14px;
    cursor:pointer;
    transition: transform .15s ease, box-shadow .15s ease, padding .15s ease;
    user-select:none;
    -webkit-tap-highlight-color:transparent;
    touch-action: manipulation;
  }

  #yes{
    background: linear-gradient(135deg, #28a745, #7CFC00);
    color:white;
    font-weight:bold;
    box-shadow:0 10px 25px rgba(0,0,0,.25);
    animation:pulse 1.2s infinite;
    position:relative;
    left:50%;
    transform:translateX(-50%);
  }
  #yes:hover{
    transform:translateX(-50%) scale(1.05);
    box-shadow:0 14px 32px rgba(0,0,0,.35);
  }
  @keyframes pulse{
    0%{transform:translateX(-50%) scale(1)}
    50%{transform:translateX(-50%) scale(1.04)}
    100%{transform:translateX(-50%) scale(1)}
  }

  #no{
    background:#f44336;
    color:white;
    font-weight:bold;
    position:absolute;
    left:50%;
    top:95px;
    transform:translateX(-50%);
  }

  #toast{
    position:fixed;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,.75);
    color:#fff;
    padding:12px 18px;
    border-radius:12px;
    font-size:16px;
    opacity:0;
    pointer-events:none;
    transition:opacity .2s ease;
    z-index:1000002;
  }
  #toast.show{opacity:1;}

  #hearts{ position:fixed; inset:0; overflow:hidden; z-index:2; pointer-events:none !important; }
  .heart{
    position:absolute;
    bottom:-40px;
    font-size:22px;
    opacity:.9;
    animation:floatUp linear forwards;
    filter: drop-shadow(0 6px 10px rgba(0,0,0,.2));
  }
  @keyframes floatUp{
    0%{transform:translateY(0) scale(.9) rotate(0deg); opacity:0;}
    10%{opacity:1;}
    100%{transform:translateY(-120vh) scale(1.35) rotate(22deg); opacity:0;}
  }

  #confetti{ position:fixed; inset:0; z-index:3; pointer-events:none !important; }

  #musicOverlay{
    position:fixed; inset:0;
    background:rgba(0,0,0,.55);
    display:flex; align-items:center; justify-content:center;
    z-index:1000000;
    padding:24px;
    pointer-events:auto !important;
  }
  #musicOverlay *{ pointer-events:none; }

  .overlayCard{
    max-width:520px; width:100%;
    background:rgba(255,255,255,.14);
    border:1px solid rgba(255,255,255,.25);
    backdrop-filter: blur(10px);
    border-radius:18px;
    padding:18px;
    text-align:center;
    color:#fff;
    box-shadow:0 18px 45px rgba(0,0,0,.25);
  }
  .overlayCard h2{ margin:0 0 10px; font-size:20px; }

  #startMusicBtn{
    width:100%;
    border-radius:14px;
    padding:14px 16px;
    font-size:18px;
    background:linear-gradient(135deg, #ff5f8a, #ff2d55);
    color:#fff;
    font-weight:700;
    box-shadow:0 12px 28px rgba(0,0,0,.25);
  }

  #finalScreen{
    display:none;
    position:fixed;
    inset:0;
    z-index:999999;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:0 18px;
    color:#fff;
  }

  #finalScreen p{
    font-size: 22px;
    margin-top: 10px;
    color: #fff;
    text-shadow: 2px 2px 5px #000;
    font-weight: normal;
  }
</style>
</head>

<body>
  <div id="hearts"></div>
  <canvas id="confetti"></canvas>

  <audio id="bgm" preload="auto" loop playsinline>
    <source src="up.mp3" type="audio/mpeg">
  </audio>

  <h1 id="mainTitle">üíñ Susy, ¬øQuieres ser mi San Valent√≠n? üíñ</h1>

  <div id="buttons">
    <button id="yes" type="button">S√≠ üíò</button>
    <button id="no" type="button">No üíî</button>
  </div>

  <div id="toast"></div>

  <div id="musicOverlay">
    <div class="overlayCard">
      <h2>üé∂ M√∫sica üé∂</h2>
      <button id="startMusicBtn" type="button">Toca la pantalla para activar</button>
    </div>
  </div>

  <div id="finalScreen">
    <div>
      <h1>üíñ ¬°Gracias Amor! üíñ</h1>
      <p>üíê Te quiero mucho Piniweenie üíê</p>
    </div>
  </div>

<script>
  let yesSize = 20;
  let yesPadding = 30;
  const MAX_YES_SIZE = 42;
  const MAX_YES_PADDING = 50;
  let noClicks = 0;
  let noIsEscaping = false;

  const noButton = document.getElementById("no");
  const yesButton = document.getElementById("yes");
  const toast = document.getElementById("toast");
  const buttonsArea = document.getElementById("buttons");
  const mainTitle = document.getElementById("mainTitle");
  const finalScreen = document.getElementById("finalScreen");
  const musicOverlay = document.getElementById("musicOverlay");
  const bgm = document.getElementById("bgm");

  const confettiCanvas = document.getElementById("confetti");
  const ctx = confettiCanvas.getContext("2d");
  let confettiPieces = [];
  let confettiAnim = null;
  let confettiEndAt = 0;

  bgm.volume = 0.25;

  function resizeConfetti(){
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;
  }
  resizeConfetti();
  window.addEventListener("resize", resizeConfetti);

  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add("show");
    setTimeout(() => toast.classList.remove("show"), 900);
  }

  function makeYesMoreLlamativo(extra = 4){
    yesSize = Math.min(yesSize + extra, MAX_YES_SIZE);
    yesPadding = Math.min(yesPadding + 4, MAX_YES_PADDING);
    yesButton.style.fontSize = yesSize + "px";
    yesButton.style.padding = "15px " + yesPadding + "px";
    yesButton.style.transform = "translateX(-50%) scale(1.06)";
    setTimeout(() => yesButton.style.transform = "translateX(-50%) scale(1.0)", 140);
  }

  function clamp(val, min, max){ return Math.min(Math.max(val, min), max); }

  function moveNo(){
    const margin = 10;
    const areaRect = buttonsArea.getBoundingClientRect();
    const btnRect = noButton.getBoundingClientRect();
    const maxX = areaRect.width - btnRect.width - margin;
    const maxY = areaRect.height - btnRect.height - margin;
    const x = Math.random() * maxX + margin;
    const y = Math.random() * maxY + margin;

    noButton.style.left = clamp(x, margin, maxX + margin) + "px";
    noButton.style.top  = clamp(y, margin, maxY + margin) + "px";
    noButton.style.transform = "none";
    makeYesMoreLlamativo(3);
  }

  function enableNoEscapeMode(){
    if(noIsEscaping) return;
    noIsEscaping = true;
    noButton.addEventListener("mouseenter", moveNo);
    noButton.addEventListener("touchstart", (e) => {
      e.preventDefault();
      moveNo();
    }, { passive:false });
  }

  noButton.addEventListener("click", (e) => {
    e.preventDefault();
    noClicks++;
    if(noClicks === 1){ showToast("Error üòÖ"); makeYesMoreLlamativo(4); return; }
    if(noClicks === 2){ showToast("¬øDe verdad? üíî"); makeYesMoreLlamativo(3); return; }
    if(noClicks === 3){ showToast("√Åndele üòÖ"); makeYesMoreLlamativo(3); return; }
    enableNoEscapeMode();
    moveNo();
  });

  const heartsContainer = document.getElementById("hearts");
  const heartEmojis = ["üíñ","üíò","üíï","üíó","üíì","üíû","‚ù§Ô∏è"];
  function rand(min, max){ return Math.random() * (max - min) + min; }

  function spawnHeart(){
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
    heart.style.left = rand(2,98) + "vw";
    heart.style.fontSize = rand(16,34) + "px";
    heart.style.animationDuration = rand(4.5,8.5) + "s";
    heartsContainer.appendChild(heart);
    setTimeout(() => heart.remove(), 9000);
  }
  setInterval(spawnHeart, 260);

  const confettiColors = ["#ff2d55","#ff5f8a","#ffd166","#06d6a0","#4d96ff","#ffffff"];

  function makeConfettiPiece(cx, cy){
    const angle = rand(0, Math.PI * 2);
    const speed = rand(9, 16);
    return {
      x: cx,
      y: cy,
      w: rand(6, 12),
      h: rand(10, 18),
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed - rand(2, 7),
      rot: rand(0, Math.PI * 2),
      vr: rand(-0.22, 0.22),
      color: confettiColors[Math.floor(Math.random() * confettiColors.length)],
      life: rand(75, 120)
    };
  }

  function explodeConfetti(x, y){
    resizeConfetti();
    confettiPieces = [];
    const count = 300;
    for(let i=0;i<count;i++) confettiPieces.push(makeConfettiPiece(x, y));
    confettiEndAt = performance.now() + 2600;
    if(confettiAnim) cancelAnimationFrame(confettiAnim);
    confettiLoop();
  }

  function confettiLoop(){
    ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);

    for(const p of confettiPieces){
      p.vx *= 0.985;
      p.vy = p.vy * 0.985 + 0.38;

      p.x += p.vx;
      p.y += p.vy;
      p.rot += p.vr;
      p.life -= 1;

      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.rot);
      ctx.globalAlpha = Math.max(0, Math.min(1, p.life / 120));
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    }

    if(performance.now() < confettiEndAt){
      confettiAnim = requestAnimationFrame(confettiLoop);
    }else{
      ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
      confettiAnim = null;
    }
  }

  async function startMusic(){
    try{
      bgm.currentTime = 0;
      await bgm.play();
      musicOverlay.style.display = "none";
    }catch{
      showToast("No se pudo reproducir");
    }
  }

  function armGlobalStart(){
    const handler = (e) => {
      try{ e.preventDefault(); }catch{}
      startMusic();
    };
    window.addEventListener("pointerdown", handler, { once:true, capture:true });
    window.addEventListener("touchstart", handler, { once:true, capture:true, passive:false });
    window.addEventListener("click", handler, { once:true, capture:true });
    window.addEventListener("keydown", handler, { once:true, capture:true });
  }
  armGlobalStart();

  yesButton.addEventListener("click", () => {
    const rect = yesButton.getBoundingClientRect();
    explodeConfetti(rect.left + rect.width/2, rect.top + rect.height/2);
    setTimeout(() => {
      mainTitle.style.display = "none";
      buttonsArea.style.display = "none";
      finalScreen.style.display = "flex";
    }, 650);
  });
</script>

</body>
</html>
